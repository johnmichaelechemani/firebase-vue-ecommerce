import{u as F,G as T,j as l,m as $,c as p,a as t,A as N,a2 as q,b as h,d as _,w as a,v as m,e as I,g as B,F as M,p as z,Y as K,H as V,J as k,X as G,Z as H,a3 as J,a0 as Q,o as v,I as P,t as g}from"./index-CDMhr0U-.js";import{g as X,r as Y,u as Z,a as O}from"./index.esm2017-jKhNGMCK.js";const W={class:"sm:ml-72 ml-20 fixed top-12 left-0 sm:w-[calc(100%-18rem)] w-[calc(100%-5rem)] h-full"},ee={class:"m-2 overflow-y-scroll no-scrollbar h-[calc(100vh-3.5rem)] pb-32"},te={action:""},se={class:"flex flex-wrap gap-2"},oe={class:"relative sm:size-20 size-10 bg-gray-500/50"},le=["src"],ae={class:"border p-2"},re={class:"border p-2"},ne={class:"border p-2"},de={class:"border flex items-center gap-1 px-3 max-w-32"},ie={class:"border p-2"},ue={class:"border flex items-center gap-1 px-3 max-w-32"},ce={class:"border p-2"},pe={class:"border flex items-center gap-1 px-3 max-w-32"},me={class:"border p-2"},ve={class:"flex flex-wrap gap-2"},ge={class:"relative overflow-x-auto shadow-sm w-full"},xe={class:"w-full text-sm text-left rtl:text-right"},ye={class:"border-b"},fe={scope:"row",class:"px-6 py-4 font-medium whitespace-nowrap"},be={class:"px-6 py-4"},we={class:"px-6 py-4"},he={class:"px-6 py-4"},_e={class:"px-6 py-4"},Ie={class:"px-6 py-4 flex justify-start items-center gap-2"},ke={class:"font-medium text-green-500 border border-green-500/20 p-1"},Pe={class:"font-medium text-red-500 border border-red-500/20 p-1"},Ue={key:0,class:""},Ae={__name:"mallProducts",setup(De){const{user:x}=F(),A=X(),U=T(),y=l([]),r=l(""),n=l(""),d=l(""),i=l(""),f=l(""),u=l(""),b=l(0),w=l(null),D=l(null),E=()=>{D.value.click()},L=o=>{const e=o.target.files[0];if(e){const s=new FileReader;s.onload=c=>{w.value=c.target.result,f.value=e},s.readAsDataURL(e)}},R=async()=>{let o="";if(f.value instanceof File)try{const e=await S(f.value,`products/${x.value.uid}/${Date.now()}_image`);e&&(o=e)}catch(e){console.error("Image upload failed:",e);return}try{await K(V(U,"products"),{name:r.value,discription:n.value,price:d.value,image:o,discount:i.value,inventory:b.value,shipping:0,quantity:1,mall:!0,ratings:0,sold:0,category:u.value,mallId:x.value.uid,mallName:k.value.userName,timestamp:G()}),console.log("Product Added Successfully"),C()}catch(e){console.error("Error adding product:",e)}console.log(r.value,n.value,d.value,i.value,u.value,x.value.uid,k.value.userName)},S=async(o,e)=>{if(!o||!x.value)return null;try{const s=Y(A,e),c=await Z(s,o);return await O(c.ref)}catch(s){return console.error("Error uploading image:",s),null}},j=()=>{const o=H(V(U,"products"),J("mallId","==",k.value.userId));Q(o,e=>{y.value=e.docs.map(s=>({id:s.id,...s.data()})),console.log("Products updated in real-time:",y.value)},e=>{console.error("Error fetching products:",e)})},C=()=>{r.value="",n.value="",d.value="",i.value="",f.value=null,u.value="",b.value=0,w.value=null,console.log("Cleared")};return $(()=>{j()}),(o,e)=>(v(),p("div",W,[t("div",ee,[e[18]||(e[18]=t("p",{class:"text-sm font-semibold py-2"},"Add Products",-1)),t("form",te,[t("div",se,[t("div",oe,[t("input",{type:"file",ref_key:"productImageInput",ref:D,onChange:L,accept:"image/*",class:"hidden"},null,544),w.value?(v(),p("img",{key:0,src:w.value,alt:"productimage",loading:"lazy",class:"w-full h-full object-cover object-center"},null,8,le)):N("",!0),t("button",{onClick:q(E,["prevent"]),class:"absolute bottom-0 shadow right-0 border-2 bg-white"},[h(_(P),{icon:"material-symbols-light:edit-outline",width:"24",height:"24"})])]),t("div",ae,[e[6]||(e[6]=t("label",{for:"name",class:"block py-1 text-xs font-medium text-gray-700"}," Name:",-1)),a(t("input",{required:"",type:"text","onUpdate:modelValue":e[0]||(e[0]=s=>r.value=s),class:"border p-1"},null,512),[[m,r.value]])]),t("div",re,[e[7]||(e[7]=t("label",{for:"name",class:"block py-1 text-xs font-medium text-gray-700"}," Discription:",-1)),a(t("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=s=>n.value=s),class:"border p-1"},null,512),[[m,n.value]])]),t("div",ne,[e[9]||(e[9]=t("label",{for:"name",class:"block py-1 text-xs font-medium text-gray-700"}," Price:",-1)),t("div",de,[e[8]||(e[8]=I(" $ ")),a(t("input",{type:"number","onUpdate:modelValue":e[2]||(e[2]=s=>d.value=s),class:"w-full outline-none p-1"},null,512),[[m,d.value]])])]),t("div",ie,[e[11]||(e[11]=t("label",{for:"name",class:"block py-1 text-xs font-medium text-gray-700"}," Discount:",-1)),t("div",ue,[a(t("input",{type:"number","onUpdate:modelValue":e[3]||(e[3]=s=>i.value=s),class:"w-full outline-none p-1"},null,512),[[m,i.value]]),e[10]||(e[10]=I(" % "))])]),t("div",ce,[e[13]||(e[13]=t("label",{for:"name",class:"block py-1 text-xs font-medium text-gray-700"}," Inventory:",-1)),t("div",pe,[e[12]||(e[12]=I(" x ")),a(t("input",{type:"number","onUpdate:modelValue":e[4]||(e[4]=s=>b.value=s),class:"w-full outline-none p-1"},null,512),[[m,b.value]])])]),t("div",me,[e[15]||(e[15]=t("label",{for:"name",class:"block py-1 text-xs font-medium text-gray-700"}," Category:",-1)),a(t("select",{name:"",required:"","onUpdate:modelValue":e[5]||(e[5]=s=>u.value=s),id:"",class:"border text-sm p-1"},e[14]||(e[14]=[t("option",{value:"Electronics",class:"text-xs font-semibold"}," Electronics ",-1),t("option",{value:"Kitchen",class:"text-xs font-semibold"}," Kitchen Tools ",-1)]),512),[[B,u.value]])])])]),t("div",{class:"flex justify-start items-center gap-3"},[t("button",{onClick:C,class:"text-sm border py-2 font-semibold my-2 w-32 px-5"}," Clear "),t("button",{onClick:R,class:"text-sm text-white font-semibold bg-gray-800 w-32 py-2 my-2 px-5"}," Add ")]),e[19]||(e[19]=t("p",{class:"text-sm font-semibold my-2"},"Product Lists",-1)),t("div",ve,[t("div",ge,[t("table",xe,[e[17]||(e[17]=t("thead",{class:"text-xs text-white uppercase bg-gray-800"},[t("tr",null,[t("th",{scope:"col",class:"px-6 py-3"},"Product name"),t("th",{scope:"col",class:"px-6 py-3"},"Category"),t("th",{scope:"col",class:"px-6 py-3"},"Inventory"),t("th",{scope:"col",class:"px-6 py-3"},"Discount"),t("th",{scope:"col",class:"px-6 py-3"},"Price"),t("th",{scope:"col",class:"px-6 py-3"},"Action")])],-1)),(v(!0),p(M,null,z(y.value,(s,c)=>(v(),p("tbody",{key:c},[t("tr",ye,[t("th",fe,g(s.name),1),t("td",be,g(s.category),1),t("td",we,g(s.inventory),1),t("td",he,g(s.discount),1),t("td",_e,"$ "+g(s.price),1),t("td",Ie,[t("button",ke,[h(_(P),{icon:"material-symbols-light:edit-outline",width:"20",height:"20"})]),t("button",Pe,[h(_(P),{icon:"material-symbols-light:restore-from-trash-outline",width:"20",height:"20"})])])])]))),128)),y.value.length===0?(v(),p("tbody",Ue,e[16]||(e[16]=[t("div",{class:"p-2 text-sm font-semibold text-gray-500"}," No Products ",-1)]))):N("",!0)])])])])]))}};export{Ae as default};
