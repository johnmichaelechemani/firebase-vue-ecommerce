import{u as V,G as z,m as u,J as s,n as y,p as F,c as g,a as e,e as w,f as k,b as _,w as x,v as N,N as $,O as q,o as f,I as U}from"./index-D62pYs8s.js";import{g as A,r as J,u as M,a as O}from"./index.esm2017-lP888mxb.js";const T={class:"sm:ml-72 ml-20 fixed top-12 left-0 sm:w-[calc(100%-18rem)] w-[calc(100%-5rem)] h-full"},G={class:"py-2"},H={class:"m-2"},K={class:"relative sm:mb-14 mb-5"},Q={class:"w-full h-32 sm:h-52 bg-gray-700/50"},W=["src"],X={class:"border-2 border-gray-700 bg-gray-700/90 absolute sm:-bottom-10 -bottom-5 left-2 shadow-xl"},Y={class:"relative sm:size-20 size-10"},Z=["src"],ee={class:"mb-3"},ae={class:"mb-3"},se={__name:"mallProfile",setup(le){const{user:r}=V(),E=z(),P=A(),n=u(null),c=u(null),m=u(null),d=u(null),t=u({userName:s.value.userName,email:s.value.email,backgroundImage:s.value.bgImage||null,profileImage:s.value.userPhotoURL||null}),v=y(()=>m.value||s.value.bgImage||null),b=y(()=>d.value||s.value.userPhotoURL||null),p=(a,l,o)=>{const i=a.target.files[0];if(i){const I=new FileReader;I.onload=j=>{l.value=j.target.result,t.value[o]=i},I.readAsDataURL(i)}},R=a=>p(a,m,"backgroundImage"),S=a=>p(a,d,"profileImage"),h=async(a,l)=>{if(!a||!r.value)return null;try{const o=J(P,l),i=await M(o,a);return await O(i.ref)}catch(o){return console.error("Error uploading image:",o),null}},C=async()=>{if(r.value)try{const a={userName:t.value.userName,email:t.value.email};if(t.value.backgroundImage instanceof File){const o=await h(t.value.backgroundImage,`users/${r.value.uid}/background_image`);o&&(a.bgImage=o)}if(t.value.profileImage instanceof File){const o=await h(t.value.profileImage,`users/${r.value.uid}/profile_image`);o&&(a.userPhotoURL=o)}const l=$(E,"users",r.value.uid);await q(l,a),s.value={...s.value,...a},localStorage.setItem("userData",JSON.stringify(s.value)),console.log("Profile updated successfully")}catch(a){console.error("Error saving profile data:",a)}},D=()=>{t.value={userName:s.value.userName,email:s.value.email,backgroundImage:null,profileImage:null},m.value=null,d.value=null,n.value.value="",c.value.value=""},B=()=>n.value.click(),L=()=>c.value.click();return F(()=>{console.log("User data loaded:",s.value)}),(a,l)=>(f(),g("div",T,[e("div",G,[e("div",H,[l[4]||(l[4]=e("h1",{class:"text-sm mb-2 font-semibold"},"Edit your Profile",-1)),e("div",K,[e("input",{type:"file",ref_key:"backgroundImageInput",ref:n,onChange:R,accept:"image/*",class:"hidden"},null,544),e("div",Q,[v.value?(f(),g("img",{key:0,src:v.value,loading:"lazy",alt:"Background Image",class:"w-full h-full object-cover object-center"},null,8,W)):w("",!0),e("button",{onClick:B,class:"absolute bottom-2 right-2 p-1 border-2 bg-white rounded-full shadow","aria-label":"Edit background image"},[k(_(U),{icon:"material-symbols-light:edit-outline",width:"24",height:"24"})])]),e("input",{type:"file",ref_key:"profileImageInput",ref:c,onChange:S,accept:"image/*",class:"hidden"},null,544),e("div",X,[e("div",Y,[b.value?(f(),g("img",{key:0,src:b.value,alt:"Profile",loading:"lazy",class:"w-full h-full object-cover object-center"},null,8,Z)):w("",!0),e("button",{onClick:L,class:"absolute -bottom-2 -right-2 border-2 bg-white rounded-full shadow","aria-label":"Edit profile image"},[k(_(U),{icon:"material-symbols-light:edit-outline",width:"24",height:"24"})])])])]),e("div",ee,[l[2]||(l[2]=e("label",{for:"storeName",class:"text-xs mb-1 font-semibold"},"Store Name:",-1)),x(e("input",{id:"storeName",type:"text","onUpdate:modelValue":l[0]||(l[0]=o=>t.value.userName=o),required:"",class:"font-semibold text-sm p-1 placeholder:text-xs placeholder:font-normal outline-gray-500/20 border w-full",placeholder:"Enter store name"},null,512),[[N,t.value.userName]])]),e("div",ae,[l[3]||(l[3]=e("label",{for:"storeEmail",class:"text-xs mb-1 font-semibold"},"Store Email:",-1)),x(e("input",{id:"storeEmail",type:"email","onUpdate:modelValue":l[1]||(l[1]=o=>t.value.email=o),required:"",class:"font-semibold text-sm p-1 placeholder:text-xs placeholder:font-normal outline-gray-500/20 border w-full",placeholder:"Enter store email"},null,512),[[N,t.value.email]])]),e("div",{class:"mb-3"},[e("div",{class:"flex items-center justify-start gap-2"},[e("button",{onClick:D,class:"w-20 border text-sm py-2 text-gray-700 font-semibold hover:bg-gray-100"}," Clear "),e("button",{onClick:C,class:"w-20 border text-sm py-2 text-white bg-gray-800 font-semibold hover:bg-gray-900"}," Save ")])])])])]))}};export{se as default};
